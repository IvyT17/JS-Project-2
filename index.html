<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="stylesheet.css">
    <script>

        var score = 0;
        var imageArray = [1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8];
        var selectedImages = [];
        var matchedImages = [];

        // set up grid with pictures
        function initialize() 
        {
            scoreElement = document.getElementById("score");
            image1 = document.getElementById("image1");
            image2 = document.getElementById("image2");
            image3 = document.getElementById("image3");
            image4 = document.getElementById("image4");
            image5 = document.getElementById("image5");
            image6 = document.getElementById("image6");
            image7 = document.getElementById("image7");
            image8 = document.getElementById("image8");
            image9 = document.getElementById("image9");
            image10 = document.getElementById("image10");
            image11 = document.getElementById("image11");
            imageE12 = document.getElementById("image12");
            image13 = document.getElementById("image13");
            image14 = document.getElementById("image14");
            image15 = document.getElementById("image15");
            image16 = document.getElementById("image16");
            images = [image1, image2, image3, image4, image5, image6, image7, 
            image8, image9, image10, image11, image12, image13, image14, image15, image16];
            shuffle(imageArray);
        }

        // score must go back to 0 AND pictures should change order too
        function resetScore() 
        {
            score = 0;
            matchedImages.length = 0;

            for (let i = 0; i < 16; i++) 
            {
                let value2 = "selectCard(" + i + ");";

                if (!matchedImages.includes(i)) 
                {
                    images[i].setAttribute("onclick", value2);
                }
            }

            for (let i = 0; i < 16; i++) 
            {
                images[i].src="images/questionmark.png";
            }

            if (selectedImages.length == 1) 
            {
                let value = "selectCard(" + selectedImages[0] + ");";
                images[selectedImages[0]].setAttribute("onclick", value);
                selectedImages.length = 0;
            }

            shuffle(imageArray);
            display();
        } 

        function selectCard(index) 
        {
            if (selectedImages.length == 1)
            {
                if (imageArray[index] == imageArray[selectedImages[0]]) 
                {
                    images[selectedImages[0]].removeAttribute("onclick");
                    images[index].removeAttribute("onclick");
                    let imageSource = "images/" + imageArray[index] + ".png";
                    images[index].src=imageSource;
                    matchedImages.push(selectedImages[0]);
                    matchedImages.push(index);
                    selectedImages.pop();
                } 

                else 
                {
                    let imageSource = "images/" + imageArray[index] + ".png";
                    images[index].src=imageSource;

                    for (let i = 0; i < 16; i++) 
                    {
                        images[i].removeAttribute("onclick");
                    }

                    setTimeout(() =>
                    {
                        console.log(selectedImages);
                        images[selectedImages[0]].src="images/questionmark.png";
                        images[index].src="images/questionmark.png";
                        let value = "selectCard(" + selectedImages[0] + ");";
                        images[selectedImages[0]].setAttribute("onclick", value);
                        value = "selectCard(" + index + ");";
                        images[index].setAttribute("onclick", value);

                        for (let i = 0; i < 16; i++) 
                        {
                            let value2 = "selectCard(" + i + ");";
                            if (!matchedImages.includes(i)) 
                            {
                                images[i].setAttribute("onclick", value2);
                            }
                        }
                        selectedImages.pop();
                    }, 1000 );
                }
                score++;
            }

            else 
            {
                selectedImages.push(index);
                let imageSource = "images/" + imageArray[index] + ".png";
                images[index].src = imageSource;
                images[index].removeAttribute("onclick");
                score++;
            }

            display();
        }


        function shuffle(array) 
        {
            let currentIndex = array.length, randomIndex;

            while (currentIndex != 0) 
            {
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex--;
                [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
            }
        }

        function display() 
        {
            scoreElement.innerHTML = "Your Score: " + score;
        }
    </script>
</head>

<body onload="initialize();">
    <div class="text">
        <h1>Match The Pictures</h1>
        <h2>Instructions:</h2>
        <p class="intro"> Match the correct pictures to win. The lower the score, the better! ;)</p>
    </div>

    <div id="grid">
        <img src="images/questionmark.png" id="image1" onclick="selectCard(0);">
        <img src="images/questionmark.png" id="image2" onclick="selectCard(1);">
        <img src="images/questionmark.png" id="image3" onclick="selectCard(2);">
        <img src="images/questionmark.png" id="image4" onclick="selectCard(3);">
        <img src="images/questionmark.png" id="image5" onclick="selectCard(4);">
        <img src="images/questionmark.png" id="image6" onclick="selectCard(5);">
        <img src="images/questionmark.png" id="image7" onclick="selectCard(6);">
        <img src="images/questionmark.png" id="image8" onclick="selectCard(7);">
        <img src="images/questionmark.png" id="image9" onclick="selectCard(8);">
        <img src="images/questionmark.png" id="image10" onclick="selectCard(9);">
        <img src="images/questionmark.png" id="image11" onclick="selectCard(10);">
        <img src="images/questionmark.png" id="image12" onclick="selectCard(11);">
        <img src="images/questionmark.png" id="image13" onclick="selectCard(12);">
        <img src="images/questionmark.png" id="image14" onclick="selectCard(13);">
        <img src="images/questionmark.png" id="image15" onclick="selectCard(14);">
        <img src="images/questionmark.png" id="image16" onclick="selectCard(15);">
    </div>

    <h2 id="score">Your Score: 0</h2>
    <button onclick="resetScore();">Reset</button>
</body>
</html>